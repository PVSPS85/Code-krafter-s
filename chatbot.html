{% extends "base.html" %}
{% block title %}AI Assistant{% endblock %}
{% block page_title %}AI Study Assistant{% endblock %}
{% block content %}

<style>
/* Chat styling inside main content, matches your website */
.chat-messages {
    padding: 16px 0 16px 0;
    min-height: 240px;
    display: flex;
    flex-direction: column;
    gap: 18px;
    background: #f9fafe;
}

.message {
    display: flex;
    gap: 13px;
    align-items: flex-start;
    margin-bottom: 2px;
}

.message.user {
    flex-direction: row-reverse;
}

.message-avatar {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 21px;
    background: #2186eb;
    color: #fff;
    font-family: inherit;
    box-shadow: 0 1.5px 6px #b0dafc;
    flex-shrink: 0;
}
.message.ai .message-avatar {
    background: #ffd36b;
    color: #685700;
    box-shadow: 0 1.5px 5px #ffe9ac;
}

.message-bubble {
    max-width: 530px;
    padding: 14px 18px;
    border-radius: 17px;
    font-size: 16px;
    background: #fff;
    color: #222;
    word-break: break-word;
    border: 1.3px solid #e3eaf6;
    white-space: pre-line;
    box-shadow: 0 1px 3px #ebf3fe;
}

.message.user .message-bubble {
    background: #2186eb;
    color: #fff;
    border-radius: 17px 5px 17px 17px;
    border: 1.3px solid #2186eb;
    margin-right: 0;
    margin-left: auto;
    box-shadow: 0 1px 4px #aad0f9;
    font-family: inherit;
}

.message.ai .message-bubble {
    background: #fffbe6;
    color: #685700;
    border-radius: 6px 17px 17px 17px;
    border: 1.3px solid #ffe16b;
    margin-left: 0;
    margin-right: auto;
    box-shadow: 0 1px 4px #ffedaa;
}

@media (max-width: 900px) {
    .message-bubble { max-width: 92vw; }
}
.chat-input-area {
    padding: 0;
    background: transparent;
    margin-top: 10px;
}
.chat-input-form {
    display: flex;
    gap: 12px;
}
.chat-input {
    flex: 1;
    padding: 13px 18px;
    border: 2px solid #d4dff1;
    border-radius: 23px;
    font-size: 16px;
    outline: none;
    background: #f8f9fb;
    transition: border .18s;
}
.chat-input:focus { border-color: #3091f2; background: #fff; }
.chat-send-btn {
    padding: 0 23px;
    background: linear-gradient(90deg, #2186eb 40%, #43c6ac 100%);
    color: #fff;
    border: none;
    border-radius: 22px;
    font-size: 17px;
    height: 48px;
    cursor: pointer;
    font-weight: bold;
    box-shadow: 0 2px 6px #d8eefe;
    transition: background 0.13s, box-shadow 0.13s;
}
.chat-send-btn:hover {
    background: linear-gradient(90deg, #43c6ac 0, #2186eb 100%);
}
.quick-questions {
    display: flex;
    flex-wrap: wrap;
    gap: 11px;
    margin-top: 12px;
    margin-bottom: 0;
    justify-content: flex-start;
}
.quick-btn {
    padding: 8px 19px;
    min-width: 128px;
    background: #e9f3ff;
    border: none;
    border-radius: 16px;
    color: #2186eb;
    font-weight: 500;
    font-size: 15px;
    cursor: pointer;
    box-shadow: 0 1.5px 6px #eef4fa;
    text-align: center;
    transition: background 0.16s, color 0.16s, box-shadow 0.16s;
}
.quick-btn:hover {
    background: #2186eb;
    color: #fff;
    box-shadow: 0 2.5px 8px #c4e1fb;
}
</style>

<div class="page-container">
    <div class="page-header">
        <h2 style="font-size: 1.6rem; font-weight: 600; margin: 0; letter-spacing: 0.5px;">
            <span style="font-size: 1.7em; vertical-align:sub; margin-right: 5px;">ü§ñ</span> AI Study Assistant
        </h2>
        <p style="color: #555a60; margin: 7px 0 0 0; font-size: 1.09em;">Ask me anything ‚Äî math, science, exams, motivation, or life!</p>
    </div>
    
    <div class="chat-messages" id="chatMessages">
        <div class="message ai">
            <div class="message-avatar">ü§ñ</div>
            <div class="message-bubble">
                Hi! I'm your AI Study Assistant. I can answer questions on math, science, English, exams, motivation, and more.
                <br><br>
                Ask me anything ‚Äî I'm here for you! üëá
            </div>
        </div>
        {% if response %}
        <div class="message user">
            <div class="message-avatar">üë§</div>
            <div class="message-bubble">{{ request.form.get('question', '') }}</div>
        </div>
        <div class="message ai">
            <div class="message-avatar">ü§ñ</div>
            <div class="message-bubble">{{ response|safe }}</div>
        </div>
        {% endif %}
    </div>
    
    <div class="chat-input-area">
        <form method="POST" class="chat-input-form" onsubmit="showTyping(event)">
            <input type="text" name="question" class="chat-input" placeholder="Type your question here..." required autocomplete="off">
            <button type="submit" class="chat-send-btn">
                <i class="fas fa-paper-plane"></i> Send
            </button>
        </form>
        <div class="quick-questions">
            <button class="quick-btn" onclick="askQuick('What is electrochemistry?')">‚ö° Electrochemistry</button>
            <button class="quick-btn" onclick="askQuick('Explain calculus')">üìê Calculus</button>
            <button class="quick-btn" onclick="askQuick('Study tips for exams')">üìù Exam Tips</button>
            <button class="quick-btn" onclick="askQuick('How to manage time?')">‚è∞ Time Mgmt</button>
            <button class="quick-btn" onclick="askQuick('I feel stressed')">üíô Motivation</button>
        </div>
    </div>
</div>
<script>
function askQuick(question) {
    document.querySelector('.chat-input').value = question;
    document.querySelector('.chat-input-form').submit();
}
function showTyping(event) {
    var messages = document.getElementById('chatMessages');
    if (messages) messages.scrollTop = messages.scrollHeight;
}
window.addEventListener('load', function() {
    var messages = document.getElementById('chatMessages');
    if (messages) messages.scrollTop = messages.scrollHeight;
});
</script>

{% endblock %}
